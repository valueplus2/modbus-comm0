# modbus-comm0
JVM平台上Modbus通讯、西门子设备通讯测试.由于目前图们方面不需要做应急准备，因此该项目暂停开发。以长春热力大数据项目优先.
### 西门子PLC、组态软件、JVM Modbus通讯程序之间的关系
PLC中写有对外通讯程序，JVM Modbus通讯程序可通过Modbus协议与PLC中对外通讯程序通信以获取PLC寄存器数据。组态软件可运行于并读写PLC(此读写与对外通讯程序无关)，实时解析PLC数据为温度、压力、流量等供热参数。
#### 西门子PLC寄存器地址示意：
```
                                   +------------------- VD0 --------------------+
                                   |                                            |
                                   +                                            +
                  +-------------- VW0 -------------+                    +----+ VW2 +------+
                  |                                |                    |                 |
                  +                                +                    +                 +
 +-------------+ VB0 +--------------+     +----+  VB1 +-----+    +---+ VB2 +---+    +--+ VB3 +--+
 |                                  |     |                 |    |             |    |           |
 +                                  +     +                 +    +             +    +           +
V0.0 V0.1 V0.2 V0.3 V0.4 V0.5 V0.6 V0.7 V1.0 V1.2 V1.3 ... V1.7 V2.0   ...   V2.7 V3.0   ...   V3.7

```
V表示一个bit，VB表示一个byte，VW表示两个byte，即一个word，VD表示四个byte，即一个double。  
V地址从V0.0开始依次为V0.0, V0.1, V0.2, ... V0.7, V1.0, V1.2, V1.3 ... V1.7, V2.0 ... V2.7 .....  
VB地址从VB0开始依次为VB0, VB1, VB2, VB3.....  
VW地址从VW0开始依次为VW0, VW1, VW2, VW3.....  
VD地址从VD0开始依次为VD0, VD1, VD2, VD3.....  
PLC中最低计数单位为byte。VW0地址中0表示起始地址的byte索引，由于VW为两个byte，因此VW0占用VB0与VB1两个地址，VW1占用VB1与VB2两个地址。VW2占用VB2与VB3两个地址。由于VW0与VW1占用地址上存在交集，因此VW0与VW2表示两个相邻存储的word类型地址。因此两个相邻word类型的地址为VWn， VWn+2，其中n为第一个起始地址的byte索引。VD类型地址同理。  
例如，存储起始地址为VB0, 则连续存储word类型的地址为VW0, VW2, VW4... 连续存储double类型的地址为VD0, VD4, VD8. 存储起始地址为VB1, 则连续存储word类型的地址为VW1, VW3, VW5... 连续存储double类型的地址为VD1, VD5, VD9.

目前PLC中对外通讯程序以VB0为起始地址作为Modbus中的Holding寄存器，及40001(Modbus中第一个Holding寄存器的地址)对应VW0地址(Modbus协议中Holding寄存器大小为16bit，也就是一个word), 40002对应VW2地址，40003对应VW4地址，以此类推。
